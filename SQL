Задание 1: Абитуриенты Есть таблица examination с двумя полями: id (id абитуриента), scores (кол-во набранных баллов дополнительного вступительного испытания от 0 до 100). 
Требуется реализовать запрос, который создаёт колонку с позицией абитуриента в общем рейтинге.

Решение 

Использвать лучше функцию DENSE_RANK(), так как некоторые абитуриенты могут написать экзамен на одинаковое количество баллов, следовательно могут быть повторы

SELECT
  id,
  scores,
  DENSE_RANK() OVER (ORDER BY scores DESC) AS rating_position
FROM examination
ORDER BY rating_position, id;





Задание 2: FULL JOIN
Представьте две таблицы: первая содержит 30 строк, а вторая — 20 строк. Мы выполняем операцию FULL JOIN между ними.
Какой диапазон возможного количества строк может быть в результирующей таблице, если учесть, что ключи для соединения могут быть как полностью совпадающими, так и абсолютно уникальными?
Ответ дать в краткой форме, например: минимально 10 и максимально 3000 строк

Ответ: минимум 30 строк, максимум 600 строк





Задание 3: Покупки 
  create table account 
( 
  id integer, -- ID счета 
  client_id integer, -- ID клиента 
  open_dt date, -- дата открытия счета 
  close_dt date -- дата закрытия счета 
) 

  create table transaction 
( 
  id integer, -- ID транзакции 
  account_id integer, -- ID счета 
  transaction_date date, -- дата транзакции 
  amount numeric(10,2), -- сумма транзакции 
  type varchar(3) -- тип транзакции 
) 

Вывести ID клиентов, которые за последний месяц по всем своим счетам совершили покупок меньше, чем на 5000 рублей. Без использования подзапросов и оконных функций.

Решение

Возьму функции JOIN, GROUP BY, HAVING, так как нужно сгрупирровать уже отфильтрованные данные. Месяц 30 дней

SELECT
    a.client_id
FROM account a
JOIN transaction t
  ON t.account_id = a.id
 AND t.type = 'BUY'
 AND t.transaction_date >= CURRENT_DATE - INTERVAL '1 month'
GROUP BY a.client_id
HAVING COALESCE(SUM(t.amount), 0) < 5000;














